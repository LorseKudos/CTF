with open("output.txt", "r") as f:
    output = f.readlines()

n = 24575303335152579483219397187273958691356380033536698304119157688003502052393867359624475789987237581184979869428436419625817866822376950791646781307952833871208386360334267547053595730896752931770589720203939060500637555186552912818531990295111060561661560818752278790449531513480358200255943011170338510477311001482737373145408969276262009856332084706260368649633253942184185551079729283490321670915209284267457445004967752486031694845276754057130676437920418693027165980362069983978396995830448343187134852971000315053125678630516116662920249232640518175555970306086459229479906220214332209106520050557209988693711

for line in output[1:]:
    line = line.strip()
    e, k = map(int, line.split(":"))
    print(e, k)
    d = k * n // e
    print((d*e - 1))

from Crypto.Util.number import *
import random
e = 65537

d = 13578907859263396375274132336627623970145066661190333994365975528296730340438023175102942113722291946379457268897608063040574280076474573783772727539002212798025513631695446792100718809332639839560501624243176240274182326753062454475863717176046534401313585308583815547854775701758559762388699640210877796380737384770326468351336643353098248331743861503930611250751779784768508280447673174142110996035545700930667699139720955384350515491053325875716252730060487994749526747957203995602876421151596737773967793701052282049892229955113136344319515162616208312453008174374824322412169675853356088258011567065591774273718

## calc p,q from e, n, d
k = e*d - 1
Is_Finish = False
while True:
    t = k
    g = random.randint(2, n-1)
    #t= k
    while t%2 == 0:
        t = t//2
        x = pow(g, t, n)
        y = GCD(x-1, n)
        if x > 1 and  y > 1:
            print("Finish!")
            q = y
            p = n//q
            Is_Finish = True
            break
    if Is_Finish:
        break
print("p: {}".format(p))
print("q: {}".format(q))

n_j = pow(p,2)*q
phi = (p-1)*(q-1)
d_j = inverse(n_j, phi)
m = pow(c_j, d_j, p*q)
print(long_to_bytes(m))
